~/workspace$ cd animal-rescue-donations
~/workspace/animal-rescue-donations$ npm run dev

> animal-rescue-donations@0.1.0 dev
> next dev

  â–² Next.js 14.2.28
  - Local:        http://localhost:3000
  - Environments: .env

 âœ“ Starting...
 âœ“ Ready in 6.3s
 â—‹ Compiling / ...
 âœ“ Compiled / in 13.7s (8586 modules)
 GET / 200 in 14559ms
 âœ“ Compiled in 1478ms (4186 modules)
 HEAD / 200 in 50ms
 â—‹ Compiling /api/chat ...
 âœ“ Compiled /api/chat in 2.4s (4637 modules)
[ğŸ§  AI Intent] AI detected general question, switching modes
[ğŸ§  Barkr] Final context: general
[ğŸ§  GPT Parser] No clear breed or location found in: hi barkr
[âš ï¸ Barkr] Invalid breed in memory, wiping: null
[âš ï¸ Barkr] Invalid location in memory, wiping: null
[ğŸ§  Final Decision] aiIntent: general, context: general, isAdoptionMode: false
 POST /api/chat 200 in 8637ms
[ğŸ§  AI Intent] AI detected adoption intent, staying in adoption mode
[ğŸ§  Barkr] Final context: adoption
[ğŸ”· Barkr] New breed provided, wiping previous: null
[ğŸ§  Final Decision] aiIntent: adoption, context: adoption, isAdoptionMode: true
[ğŸ“ Normalized Location] Keene, NH
[ğŸ¾ Barkr Memory] {
  location: 'Keene, NH',
  breed: 'chihuahuas',
  hasSeenResults: false,
  seenDogIds: [],
  cachedDogs: [],
  isAdoptionMode: true,
  isInvisibleDogsSearch: false
}
[ğŸ” Petfinder Params] { location: 'Keene, NH', breed: 'chihuahuas' }
[ğŸ§  Breed Normalization] Input: chihuahuas â†’ Cleaned: Chihuahua
[âœ… Fallback Breed Match] "Chihuahua" â†’ "Chihuahua"
[âœ… Breed Match Success] Matched to: Chihuahua
[ğŸ—„ï¸ Database] Searching database first...
[ğŸ—„ï¸ Database] Filtering by breed: Chihuahua
[ğŸ—„ï¸ Database] Filtering by location: Keene, NH
[ğŸ—„ï¸ Database] Filtering by state: NH
[âŒ Database Error] {
  message: 'TypeError: fetch failed',
  details: 'TypeError: fetch failed\n' +
    '    at node:internal/deps/undici/undici:13510:13\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
    '    at async POST (webpack-internal:///(rsc)/./app/api/chat/route.ts:1097:62)\n' +
    '    at async /home/runner/workspace/animal-rescue-donations/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:818:17)\n' +
    '    at async /home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/dev/next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/trace/trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/dev/next-dev-server.js:336:24)\n' +
    '    at async invokeRender (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/lib/router-server.js:178:21)\n' +
    '    at async handleRequest (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/lib/router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/lib/router-server.js:379:13)\n' +
    '    at async Server.requestListener (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/lib/start-server.js:141:13)',
  hint: '',
  code: ''
}
[ğŸ” Petfinder] Database returned only 0 dogs, searching Petfinder for additional...
 â—‹ Compiling /api/petfinder/search ...
 âœ“ Compiled /api/petfinder/search in 617ms (4642 modules)
[ğŸ” Enhanced Search] Starting Database â†’ Petfinder search waterfall
[ğŸ“‹ Raw Input] {
  location: 'Keene, NH',
  breed: 'Chihuahua',
  age: null,
  size: null,
  gender: null,
  limit: 25,
  isChat: true
}
[ğŸ¯ Context] Chat search - limit: 25
[ğŸ§¼ Normalized Params] { location: 'Keene, NH', breed: 'Chihuahua', limit: 25, radius: 100 }
[ğŸ’¾ Database] Searching database first...
Searching for dogs with location: Keene, NH, breed: Chihuahua, limit: 50
Error searching dogs: {
  message: 'TypeError: fetch failed',
  details: 'TypeError: fetch failed\n' +
    '    at node:internal/deps/undici/undici:13510:13\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n' +
    '    at async searchDogs (webpack-internal:///(rsc)/./lib/supabase.ts:88:33)\n' +
    '    at async POST (webpack-internal:///(rsc)/./app/api/petfinder/search/route.ts:44:32)\n' +
    '    at async /home/runner/workspace/animal-rescue-donations/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:57228\n' +
    '    at async eT.execute (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:46851)\n' +
    '    at async eT.handle (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/compiled/next-server/app-route.runtime.dev.js:6:58760)\n' +
    '    at async doRender (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:1366:42)\n' +
    '    at async cacheEntry.responseCache.get.routeKind (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:1588:28)\n' +
    '    at async DevServer.renderToResponseWithComponentsImpl (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:1496:28)\n' +
    '    at async DevServer.renderPageComponent (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:1924:24)\n' +
    '    at async DevServer.renderToResponseImpl (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:1962:32)\n' +
    '    at async DevServer.pipeImpl (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:922:25)\n' +
    '    at async NextNodeServer.handleCatchallRenderRequest (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/next-server.js:272:17)\n' +
    '    at async DevServer.handleRequestImpl (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/base-server.js:818:17)\n' +
    '    at async /home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/dev/next-dev-server.js:339:20\n' +
    '    at async Span.traceAsyncFn (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/trace/trace.js:154:20)\n' +
    '    at async DevServer.handleRequest (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/dev/next-dev-server.js:336:24)\n' +
    '    at async invokeRender (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/lib/router-server.js:178:21)\n' +
    '    at async handleRequest (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/lib/router-server.js:355:24)\n' +
    '    at async requestHandlerImpl (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/lib/router-server.js:379:13)\n' +
    '    at async Server.requestListener (/home/runner/workspace/animal-rescue-donations/node_modules/next/dist/server/lib/start-server.js:141:13)',
  hint: '',
  code: ''
}
[ğŸ¾ Petfinder] Falling back to Petfinder API...
[ğŸ“Š Current Results] 0 dogs found so far, need 25 more
[ğŸ”„ Rate Limit] Reset rate limit window
[ğŸ« Token Manager] Fetching new Petfinder access token...
[âœ… Token Manager] Got new Petfinder token, expires in 3600 seconds
[âœ… Fallback Breed Match] "Chihuahua" â†’ "Chihuahua"
[ğŸ“¡ Petfinder] Fetching: https://api.petfinder.com/v2/animals?type=dog&status=adoptable&limit=25&location=Keene%2C+NH&distance=100&breed=Chihuahua
[âœ… Petfinder Hit] Found 25 dogs from Petfinder
[ğŸ”„ Deduplication] 0 duplicates removed from Petfinder
[âœ… Search Complete] Found 25 total dogs from sources: petfinder
[ğŸ“Š Source Breakdown] petfinder: 25
 POST /api/petfinder/search 200 in 2229ms
[âœ… Chat Search Success] Found 25 dogs for chihuahuas in Keene, NH from sources: petfinder
[âœ… Petfinder Integration] Found 25 Petfinder dogs, 0 were duplicates of database dogs
[âœ… Search Complete] Total unique dogs: 25 Showing: 10
[âœ… Search Complete] Total unique dogs: 25 Showing: 10
[ğŸ“Š Scores] Sample scores: [ 'Maude: 113.4', 'Julian: 112.7', 'Maxie: 112.6' ]
 POST /api/chat 200 in 6389ms