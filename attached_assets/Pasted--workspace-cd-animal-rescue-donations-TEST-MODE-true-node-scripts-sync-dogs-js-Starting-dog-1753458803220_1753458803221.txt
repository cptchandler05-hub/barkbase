~/workspace$ cd animal-rescue-donations && TEST_MODE=true node scripts/sync-dogs.js
ğŸ• Starting dog data sync...
ğŸ§ª RUNNING IN TEST MODE - Limited API calls
ğŸ” Validating environment variables...
âœ… All environment variables present
ğŸ”— Testing Supabase connection...
âœ… Database connected! Current dogs: 0
ğŸ”‘ Fetching new Petfinder access token...
âœ… Got new Petfinder token
ğŸ§ª Test mode: Using only 2 locations to preserve API quota
ğŸ” Fetching dogs from: 99577
ğŸ“ Found 100 dogs in 99577
ğŸ” Fetching dogs from: Austin, TX
ğŸ“ Found 100 dogs in Austin, TX
ğŸ¯ Found 200 unique dogs total
ğŸ“ Syncing 200 dogs to database...
ğŸ”— Testing Supabase connection...
âœ… Connected to Supabase! Current dogs in DB: 0
âš ï¸ Skipping sync record creation - testing direct dog insertion
ğŸ§ª Testing database insertion with first dog...
ğŸ§ª Test record structure: {
  "api_source": "petfinder",
  "organization_id": "AK54",
  "url": "https://www.petfinder.com/dog/jackson-77456380/ak/anchorage/alaska-animal-rescue-friends-aarf-ak54/?referrer_id=309266f4-4871-4de8-9be8-fa0bd07816e8&utm_source=api&utm_medium=partnership&utm_content=309266f4-4871-4de8-9be8-fa0bd07816e8",
  "name": "Jackson",
  "type": "Dog",
  "species": "Dog",
  "primary_breed": "Labrador Retriever",
  "secondary_breed": null,
  "is_mixed": true,
  "is_unknown_breed": false,
  "age": "Adult",
  "gender": "Male",
  "size": "Large",
  "coat": null,
  "primary_color": null,
  "secondary_color": null,
  "tertiary_color": null,
  "status": "adoptable",
  "spayed_neutered": true,
  "house_trained": null,
  "special_needs": null,
  "shots_current": null,
  "good_with_children": null,
  "good_with_dogs": null,
  "good_with_cats": null,
  "description": "You can fill out an adoption application online on our official website.",
  "photos": [
    {
      "small": "https://dl5zpyw5k3jeb.cloudfront.net/photos/pets/77456380/1/?bust=1753396866&width=100",
      "medium": "https://dl5zpyw5k3jeb.cloudfront.net/photos/pets/77456380/1/?bust=1753396866&width=300",
      "large": "https://dl5zpyw5k3jeb.cloudfront.net/photos/pets/77456380/1/?bust=1753396866&width=600",
      "full": "https://dl5zpyw5k3jeb.cloudfront.net/photos/pets/77456380/1/?bust=1753396866"
    }
  ],
  "tags": [],
  "contact_info": {
    "email": "rescueadogtoday@gmail.com",
    "phone": "(907) 727-6728",
    "address": {
      "address1": "511 W. 41st Ave.",
      "address2": "Unit E",
      "city": "Anchorage",
      "state": "AK",
      "postcode": "99503",
      "country": "US"
    }
  },
  "city": "Anchorage",
  "state": "AK",
  "postcode": "99503",
  "latitude": null,
  "longitude": null,
  "visibility_score": 55,
  "organization_animal_id": "19749792",
  "last_updated_at": "2025-07-25T15:51:57.178Z",
  "created_at": "2025-07-25T15:51:57.178Z",
  "petfinder_id": "77456380"
}
ğŸ”‘ Record keys: [
  'api_source',         'organization_id',
  'url',                'name',
  'type',               'species',
  'primary_breed',      'secondary_breed',
  'is_mixed',           'is_unknown_breed',
  'age',                'gender',
  'size',               'coat',
  'primary_color',      'secondary_color',
  'tertiary_color',     'status',
  'spayed_neutered',    'house_trained',
  'special_needs',      'shots_current',
  'good_with_children', 'good_with_dogs',
  'good_with_cats',     'description',
  'photos',             'tags',
  'contact_info',       'city',
  'state',              'postcode',
  'latitude',           'longitude',
  'visibility_score',   'organization_animal_id',
  'last_updated_at',    'created_at',
  'petfinder_id'
]
ğŸ“Š Record has id field: false
âŒ DATABASE TEST FAILED: {
  code: '42P10',
  details: null,
  hint: null,
  message: 'there is no unique or exclusion constraint matching the ON CONFLICT specification'
}
âŒ Error details: {
  "code": "42P10",
  "details": null,
  "hint": null,
  "message": "there is no unique or exclusion constraint matching the ON CONFLICT specification"
}
âŒ Cannot proceed with sync - database structure issue
âŒ STOPPING IMMEDIATELY TO PRESERVE API QUOTA
âŒ Dog sync failed: Error: Database test failed: there is no unique or exclusion constraint matching the ON CONFLICT specification
    at syncDogsToDatabase (/home/runner/workspace/animal-rescue-donations/scripts/sync-dogs.js:241:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async main (/home/runner/workspace/animal-rescue-donations/scripts/sync-dogs.js:512:7)